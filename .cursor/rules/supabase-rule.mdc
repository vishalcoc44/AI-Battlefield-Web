---
alwaysApply: true
---
# Overview

# Supabase Schema Management Rules

1.  **Source of Truth:** Before proposing any SQL fixes, migrations, or queries, you MUST always reference the current schema definitions located in `Supabase/current_schema/`.
    *   `tables_dump.json` (Table definitions)
    *   `All_Constraints.json` (Foreign Keys and Checks)
    *   `All_RLS_Policies.json` (Security Policies)
    *   `All_Triggers.json` (Database Triggers)
    *   `All_Functions.json` (Custom Functions)
    *   `All_Types.json` (Enum Types and Custom Types)
    *   `Storage_Buckets.json` (Storage Bucket Configurations)

2.  **Verify Before Fix:** Do not assume the state of the database. Check these files to see if a column, constraint, policy, function, type, or bucket already exists or conflicts with your proposed change.

3.  **Sync Documentation:** When you provide a SQL fix or migration (e.g., creating a new migration file), you MUST simultaneously update the corresponding file in `supabase/current_schema/` to reflect the change.
    *   *Example:* If you add a `delete` policy for `teams`, you must append the new policy definition to `All_RLS_Policies.json`.
    *   *Example:* If you add a Foreign Key, update `All_Constraints.json`.
    *   *Example:* If you create a custom function, update `All_Functions.json`.
    *   *Example:* If you create an enum type, update `All_Types.json`.
    *   *Example:* If you create a storage bucket, update `Storage_Buckets.json`.

    **ALWAYS UPDATE ALL FILES RELATED WHENEVER U UPDATE OR GIVE ME SQL FOR THESE 7 JSON FILES IF NEEDED. DONT FORGET. THIS IS VERY VERY VERY IMPORTANT.
    ADD THEM IN EVERY TASK FOR EVERY EDIT!!**

4.  **Format:** Maintain the existing JSON structure of these files when appending or modifying entries.
